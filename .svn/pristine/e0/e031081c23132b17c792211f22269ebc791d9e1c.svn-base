using System;
using System.Collections.Generic;
using System.Data;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using Datos;

namespace Negocio
{
    public class Usuario
    {
        #region ATRIBUTOS
        private int? id;
        private string user;
        private string password;
        private int? rolId;
        #endregion

        #region PROPIEDADES
        public int? Id { 
            get{ return id;}
            set { id = value;} }
        public string User { 
            get{ return user;}
            set { user = value;} }
        public string Password { 
            get{ return password;}
            set { password = value;} }
        public int? RolId
        {
            get { return rolId; }
            set { rolId = value; }
        }
        #endregion

        #region METODOS
        public static Usuario ValidarExitencia(Usuario usuario) 
        {
            try
            {   
                Ejecucion e = new Ejecucion();

                DataTable dt = e.Exec("SELECT * FROM Usuarios WHERE User = '" + usuario.User + "' AND Password = '" + usuario.Password + "';");

                if (dt.Rows.Count == 0) { throw new Exception("Usuario no encontrado"); }
                if (dt.Rows.Count > 1) { throw new Exception("Existen multiples usuarios con esa descripcion"); }

                 usuario.Id = Convert.ToInt32(dt.Rows[0]["Id"]);
                usuario.User = Convert.ToString(dt.Rows[0]["User"]);
                usuario.Password = Convert.ToString(dt.Rows[0]["Password"]);
                usuario.rolId = Convert.ToInt32(dt.Rows[0]["RolId"]);

                return usuario;
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
        #endregion
    }
}
